import classification_starter as classif

#3086 files in training set
withhold = 0

"""values of 'load':
  'extract': load the extracted features; use if feature-functions are unchanged
              'extractedFile' must be provided
  'split'  : load the partitioned data
              'splitFile' must be provided
  None     : Load all data from original xml files
              if 'extractFile' provided, will save the extracted features
              if 'splitfile' provided, will also save the split data"""

"""value of splitMethod (used for consistent testing):
0: random
1: last 'withhold' are withheld
2: first 'withhold' are withheld"""

# params = {'load': None,
#           'extractFile': 'Output/extractFile',
#           'extractTestFile': 'Output/extractTestFile',
#           'splitFile': 'Output/splitFile',
#           'writePredict': True,
#           # 'outputFile': 'Output/predict_oneVRest_3grams.csv',
#           'splitMethod': 0,
#           'options':{ },
#           'option':'mode',
#           'range':['oneVOne','oneVRest']
# }

params = {'load': None,
          'extractFile': 'Output/extractFile',
          'extractTestFile': 'Output/extractTestFile',
          'splitFile': 'Output/splitFile',
          'writePredict': True,
          # 'outputFile': 'Output/predict_oneVRest_3grams.csv',
          'splitMethod': 0,
          'options':{
            'mode':'oneVRest',
            'reduction': 'tsvd'
          },
          'option':'n_components',
          'range':[1, 2, 5, 10, 50, 100]
}


outputs = {}

# n-grams
# ff_combos = [['system_call_1gram_feats'],['system_call_2gram_feats'],['system_call_3gram_feats'],['system_call_5gram_feats'],['system_call_8gram_feats'], ['system_call_10gram_feats']]
# ff_combos = [['system_call_20gram_feats']]

# # n-gram combinations
# ff_combos = [['system_call_1gram_feats', 'system_call_2gram_feats'],['system_call_2gram_feats','system_call_3gram_feats'],['system_call_3gram_feats','system_call_5gram_feats'],\
#   ['system_call_5gram_feats','system_call_8gram_feats'], ['system_call_8gram_feats','system_call_10gram_feats'],
#   ['system_call_1gram_feats', 'system_call_3gram_feats', 'system_call_5gram_feats'],\
#   ['system_call_3gram_feats', 'system_call_5gram_feats', 'system_call_8gram_feats'],\
#   ['system_call_5gram_feats', 'system_call_8gram_feats', 'system_call_10gram_feats'],\
#   ['system_call_1gram_feats', 'system_call_5gram_feats', 'system_call_10gram_feats'],\
#   ]

# best-performing n-gram combinations
ff_combos = [['system_call_8gram_feats'],\
  ['system_call_20gram_feats'],\
  ['system_call_8gram_feats','system_call_10gram_feats'],\
  ['system_call_5gram_feats', 'system_call_8gram_feats', 'system_call_10gram_feats'],\
]



for ffs in ff_combos:
  value = ffs
  print 
  print "################################################################################"
  print "Feature functions: " + str(value)

  params['ffs'] = ffs
  results = classif.mainTestIter(0, params)

  if(isinstance(value, list)):
    value = tuple(value)
  outputs[value] = results

print "\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%"
import pprint
pp = pprint.PrettyPrinter(indent=4)


print "Results:"
print outputs
print 
pp.pprint(outputs)